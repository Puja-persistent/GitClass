hejdkks,updated this bug 1 logic

bug2 fixed,additional changes